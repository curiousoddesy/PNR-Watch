<!DOCTYPE html>
<html lang="en" class="h-full">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="PNR Ticket Status Display - View your train ticket details">
    <title>PNR Status - 245-5423890</title>
    
    <!-- Tailwind CSS with custom configuration -->
    <script src="https://cdn.tailwindcss.com"></script>
    <script>
        tailwind.config = {
            darkMode: 'class',
            theme: {
                extend: {
                    colors: {
                        primary: '#137fec',
                        'background-light': '#f6f7f8',
                        'background-dark': '#101922'
                    },
                    fontFamily: {
                        sans: ['Public Sans', 'system-ui', 'sans-serif']
                    },
                    fontWeight: {
                        normal: '400',
                        medium: '500',
                        semibold: '600',
                        bold: '700'
                    }
                }
            }
        }
    </script>
    
    <!-- Public Sans Font -->
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Public+Sans:wght@400;500;600;700&display=swap" rel="stylesheet">
    
    <!-- Material Symbols Font -->
    <link rel="stylesheet" href="https://fonts.googleapis.com/css2?family=Material+Symbols+Outlined:opsz,wght,FILL,GRAD@20..48,100..700,0..1,-50..200" />
    
    <!-- Custom CSS -->
    <link rel="stylesheet" href="../styles.css">
</head>
<body class="font-sans bg-background-light dark:bg-background-dark text-slate-900 dark:text-white antialiased" style="min-height: max(884px, 100dvh);">
    <!-- Main application container -->
    <div id="app" class="min-h-full">
        <!-- Sticky Header Component -->
        <header class="sticky top-0 z-10 bg-background-light dark:bg-background-dark shadow-sm p-4 pb-2 flex items-center justify-between">
            <!-- Back button -->
            <button class="flex items-center justify-center w-12 h-12 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors">
                <span class="material-symbols-outlined text-slate-700 dark:text-slate-300">
                    arrow_back
                </span>
            </button>
            
            <!-- Centered title -->
            <h1 class="text-lg font-semibold text-slate-900 dark:text-white">
                PNR Status
            </h1>
            
            <!-- Share button -->
            <button class="flex items-center justify-center w-12 h-12 rounded-full hover:bg-slate-100 dark:hover:bg-slate-700 transition-colors">
                <span class="material-symbols-outlined text-slate-700 dark:text-slate-300">
                    share
                </span>
            </button>
        </header>

        <!-- Main Content -->
        <main class="px-4 pb-4">
            <!-- Status Card -->
            <div class="bg-[#28a745] rounded-lg pt-[100px] pb-6 px-6 mb-6 text-white" style="box-shadow: 0 0 4px rgba(0,0,0,0.1);">
                <div class="text-center">
                    <h2 class="text-lg font-semibold mb-2">PNR: 245-5423890</h2>
                    <div class="text-2xl font-bold mb-2">CONFIRMED</div>
                    <p class="text-sm opacity-90">Your ticket has been confirmed. Have a safe journey!</p>
                </div>
            </div>

            <!-- Save PNR Button Component -->
            <div class="mb-6">
                <button id="savePnrButton" class="w-full bg-primary/10 dark:bg-primary/20 text-primary dark:text-primary hover:bg-primary/20 dark:hover:bg-primary/30 px-4 py-3 rounded-lg flex items-center justify-center gap-2 transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 focus:ring-offset-background-light dark:focus:ring-offset-background-dark">
                    <span class="material-symbols-outlined">
                        bookmark_add
                    </span>
                    <span class="font-medium">Save PNR for Notifications</span>
                </button>
            </div>

            <!-- Train Details Section -->
            <div class="mb-6">
                <h2 class="text-lg font-semibold text-slate-900 dark:text-white mb-4">Train Details</h2>
                <div class="bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700">
                    <div class="grid grid-cols-1 divide-y divide-slate-200 dark:divide-slate-700">
                        <div class="p-4">
                            <div class="text-sm text-slate-600 dark:text-slate-400 mb-1">Train</div>
                            <div class="font-medium text-slate-900 dark:text-white">12345 | SUPERFAST EXP</div>
                        </div>
                        <div class="p-4">
                            <div class="text-sm text-slate-600 dark:text-slate-400 mb-1">Class</div>
                            <div class="font-medium text-slate-900 dark:text-white">Sleeper (SL)</div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Journey Itinerary Section -->
            <div class="mb-6">
                <h2 class="text-lg font-semibold text-slate-900 dark:text-white mb-4">Journey Itinerary</h2>
                <div class="bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700 p-4">
                    <div class="relative">
                        <!-- Timeline -->
                        <div class="flex flex-col space-y-6">
                            <!-- Departure -->
                            <div class="flex items-start">
                                <div class="flex flex-col items-center mr-4">
                                    <div class="w-3 h-3 bg-primary rounded-full"></div>
                                    <div class="w-0.5 h-16 bg-slate-300 dark:bg-slate-600 mt-2"></div>
                                </div>
                                <div class="flex-1 pt-0">
                                    <div class="font-medium text-slate-900 dark:text-white">New Delhi (NDLS)</div>
                                    <div class="text-sm text-slate-600 dark:text-slate-400">15 Jul 2024, 20:40</div>
                                    <div class="text-xs text-slate-500 dark:text-slate-500 mt-1">Departure</div>
                                </div>
                            </div>
                            
                            <!-- Arrival -->
                            <div class="flex items-start">
                                <div class="flex flex-col items-center mr-4">
                                    <div class="w-3 h-3 bg-primary rounded-full"></div>
                                </div>
                                <div class="flex-1 pt-0">
                                    <div class="font-medium text-slate-900 dark:text-white">Mumbai Central (MMCT)</div>
                                    <div class="text-sm text-slate-600 dark:text-slate-400">16 Jul 2024, 12:30</div>
                                    <div class="text-xs text-slate-500 dark:text-slate-500 mt-1">Arrival</div>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>

            <!-- Passenger Information Section -->
            <div class="mb-6">
                <h2 class="text-lg font-semibold text-slate-900 dark:text-white mb-4">Passenger Information</h2>
                <div class="bg-white dark:bg-slate-800 rounded-lg border border-slate-200 dark:border-slate-700">
                    <div class="divide-y divide-slate-200 dark:divide-slate-700">
                        <!-- Passenger 1 -->
                        <div class="p-4">
                            <div class="grid grid-cols-3 gap-4 items-center">
                                <div>
                                    <div class="font-medium text-slate-900 dark:text-white">John Doe</div>
                                    <div class="text-sm text-slate-600 dark:text-slate-400">Age: 28, Male</div>
                                </div>
                                <div class="text-center">
                                    <div class="font-medium text-slate-900 dark:text-white">S5</div>
                                    <div class="text-sm text-slate-600 dark:text-slate-400">32 (Upper)</div>
                                </div>
                                <div class="text-right">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-200">
                                        Confirmed
                                    </span>
                                </div>
                            </div>
                        </div>
                        
                        <!-- Passenger 2 -->
                        <div class="p-4">
                            <div class="grid grid-cols-3 gap-4 items-center">
                                <div>
                                    <div class="font-medium text-slate-900 dark:text-white">Jane Smith</div>
                                    <div class="text-sm text-slate-600 dark:text-slate-400">Age: 25, Female</div>
                                </div>
                                <div class="text-center">
                                    <div class="font-medium text-slate-900 dark:text-white">S5</div>
                                    <div class="text-sm text-slate-600 dark:text-slate-400">33 (Lower)</div>
                                </div>
                                <div class="text-right">
                                    <span class="inline-flex items-center px-2.5 py-0.5 rounded-full text-xs font-medium bg-green-100 dark:bg-green-900/50 text-green-800 dark:text-green-200">
                                        Confirmed
                                    </span>
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
            
        </main>

        <!-- Floating Refresh Button -->
        <button class="fixed bottom-6 right-6 h-14 w-14 bg-primary hover:bg-primary/90 text-white rounded-full shadow-lg flex items-center justify-center transition-colors focus:outline-none focus:ring-2 focus:ring-primary focus:ring-offset-2 focus:ring-offset-background-light dark:focus:ring-offset-background-dark">
            <span class="material-symbols-outlined">
                refresh
            </span>
        </button>
    </div>

    <!-- Theme toggle script for testing -->
    <script>
        // Simple theme toggle for development/testing
        function toggleTheme() {
            document.documentElement.classList.toggle('dark');
        }
        
        // Check for saved theme preference or default to light mode
        if (localStorage.theme === 'dark' || (!('theme' in localStorage) && window.matchMedia('(prefers-color-scheme: dark)').matches)) {
            document.documentElement.classList.add('dark');
        } else {
            document.documentElement.classList.remove('dark');
        }
        
        // Save theme preference
        function setTheme(theme) {
            localStorage.theme = theme;
            if (theme === 'dark') {
                document.documentElement.classList.add('dark');
            } else {
                document.documentElement.classList.remove('dark');
            }
        }

        // PNR saving functionality
        let pnrSaved = false;

        function savePnr(pnrNumber) {
            // Simulate saving PNR to local storage or API
            const savedPnrs = JSON.parse(localStorage.getItem('savedPnrs') || '[]');
            if (!savedPnrs.includes(pnrNumber)) {
                savedPnrs.push(pnrNumber);
                localStorage.setItem('savedPnrs', JSON.stringify(savedPnrs));
                pnrSaved = true;
                return true;
            }
            return false;
        }

        function isPnrSaved(pnrNumber) {
            const savedPnrs = JSON.parse(localStorage.getItem('savedPnrs') || '[]');
            return savedPnrs.includes(pnrNumber);
        }

        // Basic interactivity
        document.addEventListener('DOMContentLoaded', function() {
            const currentPnr = '245-5423890';
            
            // Back button functionality
            const backButton = document.querySelector('header button:first-child');
            backButton.addEventListener('click', function() {
                console.log('Back button clicked');
                // In a real app, this would navigate back
                alert('Navigating back to PNR input');
            });

            // Share button functionality
            const shareButton = document.querySelector('header button:last-child');
            shareButton.addEventListener('click', function() {
                console.log('Share button clicked');
                // In a real app, this would open share modal
                alert('Opening share options');
            });

            // Refresh button functionality
            const refreshButton = document.querySelector('.fixed.bottom-6');
            refreshButton.addEventListener('click', function() {
                console.log('Refresh button clicked');
                // In a real app, this would refresh the PNR status
                alert('Refreshing PNR status...');
            });

            // Save PNR button functionality
            const savePnrButton = document.getElementById('savePnrButton');
            
            // Check if PNR is already saved and update button state
            if (isPnrSaved(currentPnr)) {
                updateSaveButtonState(savePnrButton, true);
            }

            savePnrButton.addEventListener('click', function() {
                console.log('Save PNR button clicked');
                
                if (!pnrSaved && !isPnrSaved(currentPnr)) {
                    const success = savePnr(currentPnr);
                    if (success) {
                        updateSaveButtonState(savePnrButton, true);
                        alert('PNR saved for notifications!');
                    } else {
                        alert('PNR is already saved');
                    }
                } else {
                    alert('PNR is already saved for notifications');
                }
            });

            // Run basic unit tests
            runSaveFunctionalityTests();
        });

        function updateSaveButtonState(button, saved) {
            if (saved) {
                button.innerHTML = `
                    <span class="material-symbols-outlined">
                        bookmark_added
                    </span>
                    <span class="font-medium">PNR Saved for Notifications</span>
                `;
                button.classList.add('opacity-75');
                button.disabled = true;
                pnrSaved = true;
            }
        }

        // Unit tests for save functionality
        function runSaveFunctionalityTests() {
            console.log('Running save functionality tests...');
            
            // Test PNR saving logic
            function testPnrSavingLogic() {
                // Clear any existing saved PNRs for testing
                localStorage.removeItem('savedPnrs');
                
                const testPnr = '123-4567890';
                const result = savePnr(testPnr);
                console.assert(result === true, 'Should successfully save new PNR');
                
                const savedPnrs = JSON.parse(localStorage.getItem('savedPnrs') || '[]');
                console.assert(savedPnrs.includes(testPnr), 'PNR should be in saved list');
                
                // Test duplicate saving
                const duplicateResult = savePnr(testPnr);
                console.assert(duplicateResult === false, 'Should not save duplicate PNR');
                
                console.log('✓ PNR saving logic test passed');
            }

            // Test save button component
            function testSaveButtonComponent() {
                const saveButton = document.getElementById('savePnrButton');
                console.assert(saveButton, 'Save PNR button should exist');
                
                const hasCorrectClasses = saveButton.classList.contains('w-full') && 
                                        saveButton.classList.contains('bg-primary/10') &&
                                        saveButton.classList.contains('px-4') &&
                                        saveButton.classList.contains('py-3') &&
                                        saveButton.classList.contains('gap-2');
                console.assert(hasCorrectClasses, 'Save button should have correct styling classes');
                
                const icon = saveButton.querySelector('.material-symbols-outlined');
                console.assert(icon && icon.textContent.trim() === 'bookmark_add', 'Save button should have bookmark_add icon');
                
                const text = saveButton.textContent.includes('Save PNR for Notifications');
                console.assert(text, 'Save button should have correct text');
                
                console.log('✓ Save button component test passed');
            }

            // Test isPnrSaved function
            function testIsPnrSavedFunction() {
                localStorage.setItem('savedPnrs', JSON.stringify(['245-5423890', '123-4567890']));
                
                const result1 = isPnrSaved('245-5423890');
                console.assert(result1 === true, 'Should return true for saved PNR');
                
                const result2 = isPnrSaved('999-8888777');
                console.assert(result2 === false, 'Should return false for unsaved PNR');
                
                console.log('✓ isPnrSaved function test passed');
            }

            // Run all tests
            try {
                testPnrSavingLogic();
                testSaveButtonComponent();
                testIsPnrSavedFunction();
                console.log('✅ All save functionality tests passed!');
            } catch (error) {
                console.error('❌ Test failed:', error);
            }
        }
    </script>
</body>
</html>